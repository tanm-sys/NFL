# ============================================================================
# PRODUCTION TRAINING CONFIGURATION
# ============================================================================
# This is the main configuration file for production NFL model training.
# Optimized for Google Colab with T4/A100 GPUs.

# Experiment Metadata
experiment_name: "nfl_production_v1"
description: "Full production training on all 18 weeks with best hyperparameters"

# Data Configuration
data:
  data_dir: "."
  weeks: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
  train_split: 0.8
  val_split: 0.1
  test_split: 0.1
  validate_data: true
  radius: 20.0  # Graph construction radius in yards
  future_seq_len: 10  # Predict 10 future frames

# Model Architecture
model:
  input_dim: 7
  hidden_dim: 64
  num_gnn_layers: 4
  heads: 4
  dropout: 0.1
  probabilistic: false  # Set true for GMM decoder
  num_modes: 6  # Only used if probabilistic=true
  use_scene_encoder: true  # P3 enhancement

# Training Configuration
training:
  batch_size: 32
  learning_rate: 0.001
  max_epochs: 100
  min_epochs: 10
  num_workers: 4  # Reduce to 2 on Colab if memory issues
  accumulate_grad_batches: 1  # Increase for effective larger batch size
  
# Optimization
optimizer:
  type: "adamw"
  weight_decay: 0.0001
  betas: [0.9, 0.999]
  eps: 1.0e-08
  
# Learning Rate Scheduler
lr_scheduler:
  type: "cosine_warmup"
  warmup_epochs: 5
  min_lr: 1.0e-06
  
# Loss Weights (Multi-task learning)
loss_weights:
  trajectory: 1.0
  velocity: 0.3
  acceleration: 0.1
  collision: 0.05
  coverage: 0.5
  
# Regularization
regularization:
  gradient_clip_val: 1.0
  use_augmentation: true
  use_huber_loss: false
  huber_delta: 1.0
  label_smoothing: 0.0
  
# Hardware Configuration
hardware:
  precision: "16-mixed"  # Options: "32", "16-mixed", "bf16-mixed"
  accelerator: "auto"  # auto, gpu, cpu
  devices: "auto"  # auto, 1, 2, etc.
  strategy: "auto"  # auto, ddp, ddp_spawn
  
# Callbacks
callbacks:
  early_stopping:
    enabled: true
    patience: 10
    min_delta: 0.001
    monitor: "val_ade"
    mode: "min"
    
  model_checkpoint:
    save_top_k: 3
    monitor: "val_ade"
    mode: "min"
    save_last: true
    
# Experiment Tracking
logging:
  use_mlflow: true
  use_wandb: true
  use_tensorboard: true
  log_every_n_steps: 50
  
# Paths
paths:
  checkpoint_dir: "./checkpoints"
  log_dir: "./logs"
  output_dir: "./outputs"
  
# Reproducibility
reproducibility:
  seed: 42
  deterministic: true
  benchmark: false
  
# Production Features
production:
  enable_profiling: false
  export_onnx: true
  export_torchscript: true
  save_config: true
  
# Monitoring Thresholds (for alerts)
thresholds:
  target_val_ade: 2.5  # yards
  target_val_fde: 4.0  # yards
  target_val_miss_rate: 0.30
  target_val_cov_acc: 0.80
