# ============================================================================
# ðŸ† MAXIMUM ACCURACY CONFIG - RTX 3050 4GB OPTIMIZED
# ============================================================================
# Pushes model capacity to the limit while staying within 4GB VRAM.
# Uses all SOTA techniques for best trajectory prediction accuracy.

experiment_name: "nfl_max_accuracy"
description: "Maximum accuracy for RTX 3050 4GB - all SOTA enabled"

# Data Configuration
data_dir: "."
weeks: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
train_split: 0.8
val_split: 0.1
test_split: 0.1
radius: 20.0
future_seq_len: 10
history_len: 5

# ============================================================================
# MODEL ARCHITECTURE - MAXIMUM FOR 4GB VRAM
# ============================================================================
input_dim: 9
hidden_dim: 256              # Sweet spot for 4GB
num_gnn_layers: 8            # Deep network - more layers > wider
heads: 8                     # Maximum attention heads
dropout: 0.12                # Moderate regularization
droppath_rate: 0.15          # Strong stochastic depth

# Probabilistic Decoder
probabilistic: true
num_modes: 8                 # More modes for trajectory diversity

# Temporal Encoder
temporal_encoder_type: "hybrid"  # Best of LSTM + attention
use_scene_encoder: true

# ============================================================================
# TRAINING - OPTIMIZED FOR 4GB VRAM
# ============================================================================
batch_size: 24               # Reduced for larger model
accumulate_grad_batches: 6   # Effective batch = 144
learning_rate: 0.001         # Scaled for effective batch
max_epochs: 150
min_epochs: 40

# Optimizer
optimizer: "lion"            # Lion optimizer - faster convergence
weight_decay: 0.02
betas: [0.9, 0.99]

# LR Scheduler
lr_scheduler: "cosine_warmup"
warmup_epochs: 8
min_lr: 1.0e-07

# ============================================================================
# LOSS WEIGHTS - BALANCED MULTI-TASK
# ============================================================================
trajectory_weight: 1.0
velocity_weight: 0.5
acceleration_weight: 0.25
collision_weight: 0.1
coverage_weight: 0.6

# SOTA Contrastive Losses
use_social_nce: true
social_nce_weight: 0.15
social_nce_temperature: 0.07

use_contrastive_loss: true
contrastive_weight: 0.08

use_wta_loss: true
wta_k_best: 2               # Top-2 for better multi-modal

use_diversity_loss: true
diversity_weight: 0.03
diversity_min_distance: 2.5

use_endpoint_focal: true
endpoint_focal_weight: 0.25
endpoint_focal_gamma: 2.5

# ============================================================================
# REGULARIZATION - PREVENT OVERFITTING
# ============================================================================
gradient_clip_val: 0.5       # Tighter clipping
use_augmentation: true
use_huber_loss: true
huber_delta: 0.8
label_smoothing: 0.12

# ============================================================================
# HARDWARE - RTX 3050 4GB OPTIMIZED
# ============================================================================
precision: "16-mixed"        # Essential for 4GB
accelerator: "gpu"
devices: 1
benchmark: true
deterministic: false

# ============================================================================
# CALLBACKS
# ============================================================================
early_stopping_patience: 25
early_stopping_min_delta: 0.0002
monitor_metric: "val_minADE"  # Best metric for multi-modal
save_top_k: 5
save_last: true

# SWA for final boost
swa_enabled: true
swa_epoch_start: 0.7
swa_lrs: 5.0e-06
swa_annealing_epochs: 8

# ============================================================================
# TARGETS (Aggressive but achievable)
# ============================================================================
target_val_ade: 0.35
target_val_minADE: 0.28
target_val_fde: 0.55
target_val_miss_rate: 0.03
