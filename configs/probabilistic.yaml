# Probabilistic GMM Decoder Configuration
# For uncertainty-aware trajectory prediction

experiment_name: "nfl_probabilistic_gmm"
description: "Probabilistic training with 6-mode GMM decoder"

# Data Configuration
data_dir: "."
weeks: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
train_split: 0.8
val_split: 0.1
test_split: 0.1
validate_data: true
radius: 20.0
future_seq_len: 10

# Model Architecture
input_dim: 9
hidden_dim: 64
num_gnn_layers: 4
heads: 4
dropout: 0.1
probabilistic: true  # Enable GMM decoder
num_modes: 6  # 6 trajectory modes
droppath_rate: 0.05  # Moderate stochastic depth
use_scene_encoder: true

# Training Configuration
batch_size: 24  # Slightly smaller due to GMM overhead
learning_rate: 0.0008  # Slightly lower for stability
max_epochs: 120
min_epochs: 15
num_workers: 4
accumulate_grad_batches: 1

# Optimization
optimizer: "adamw"
weight_decay: 0.0001
betas: [0.9, 0.999]
eps: 1.0e-08

# Learning Rate Scheduler
lr_scheduler: "cosine_warmup"
warmup_epochs: 8  # Longer warmup for GMM
min_lr: 1.0e-07

# Loss Weights
trajectory_weight: 1.0  # NLL loss for GMM
velocity_weight: 0.2  # Reduced weight
acceleration_weight: 0.1
collision_weight: 0.05
coverage_weight: 0.5

# Regularization
gradient_clip_val: 1.0
use_augmentation: true
use_huber_loss: false
huber_delta: 1.0
label_smoothing: 0.0

# Hardware Configuration (Auto-detected based on GPU)
precision: "auto"  # Auto-detects optimal precision for your hardware
accelerator: "auto"
devices: "auto"
strategy: "auto"

# Callbacks
early_stopping_patience: 12  # More patience for GMM
early_stopping_min_delta: 0.001
monitor_metric: "val_ade"
save_top_k: 3
save_last: true

# Stochastic Weight Averaging (SWA)
swa_enabled: true
swa_epoch_start: 0.75
swa_lrs: 1.0e-05
swa_annealing_epochs: 5

# Experiment Tracking
use_mlflow: true
use_wandb: true
use_tensorboard: true
log_every_n_steps: 50

# Paths
checkpoint_dir: "./checkpoints_gmm"
log_dir: "./logs_gmm"
output_dir: "./outputs_gmm"

# Reproducibility
seed: 42
deterministic: true
benchmark: false

# Production Features
enable_profiling: false
export_onnx: true
export_torchscript: true
save_config: true

# Target Metrics
target_val_ade: 2.3  # GMM should achieve better accuracy
target_val_fde: 3.8
target_val_miss_rate: 0.25
target_val_cov_acc: 0.82
