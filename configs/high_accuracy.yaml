# ============================================================================
# üèÜ WORLD-CLASS MODEL CONFIGURATION - RTX 4050 OPTIMIZED
# ============================================================================
# Maximum quality + Maximum speed for RTX 4050 (6GB VRAM, Ada Lovelace)
# This configuration uses SOTA techniques from Waymo/Argoverse competitions.

experiment_name: "nfl_worldclass"
description: "World-class trajectory prediction - RTX 4050 optimized"

# Data Configuration
data_dir: "."
weeks: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
train_split: 0.8
val_split: 0.1
test_split: 0.1
validate_data: false
radius: 20.0
future_seq_len: 10

# Model Architecture - WORLD-CLASS (maximized for 6GB VRAM)
input_dim: 9
hidden_dim: 256            # Maximum expressiveness
num_gnn_layers: 8          # Deep network for complex patterns
heads: 8                   # Optimal attention heads
dropout: 0.15              # Moderate dropout
probabilistic: false
num_modes: 6
droppath_rate: 0.1          # Strong stochastic depth
use_scene_encoder: true

# Training - SOTA STRATEGY
batch_size: 160            # Optimal for 6GB VRAM with bf16
learning_rate: 0.0015      # Scaled for batch size
max_epochs: 120
min_epochs: 30
num_workers: 0  # Set to 0 to avoid multiprocessing deadlocks
accumulate_grad_batches: 1

# Optimization - WORLD-CLASS
optimizer: "adamw"
weight_decay: 0.01         # Stronger for larger model
betas: [0.9, 0.999]
eps: 1.0e-08

# Learning Rate Scheduler - Warmup + Cosine
lr_scheduler: "cosine_warmup"
warmup_epochs: 5
min_lr: 1.0e-07

# Loss Weights - Multi-task SOTA
trajectory_weight: 1.0
velocity_weight: 0.4              # Increased for smoother trajectories
acceleration_weight: 0.2          # Physics-aware
collision_weight: 0.08            # Player separation
coverage_weight: 0.5

# Regularization - ANTI-OVERFITTING
gradient_clip_val: 1.0
use_augmentation: true
use_huber_loss: true
huber_delta: 1.0
label_smoothing: 0.1       # Prevents overconfidence

# Hardware - Auto-detected for maximum utilization
precision: "auto"  # Auto-detects: bf16-mixed (RTX 30/40, A100), 16-mixed (RTX 20), 32 (CPU/old GPUs)
accelerator: "gpu"
devices: 1
strategy: "auto"

# Callbacks - BALANCED
early_stopping_patience: 20
early_stopping_min_delta: 0.0003
monitor_metric: "val_ade"
save_top_k: 5
save_last: true

# Stochastic Weight Averaging (SWA)
swa_enabled: true
swa_epoch_start: 0.75
swa_lrs: 1.0e-05
swa_annealing_epochs: 5

# Experiment Tracking
use_mlflow: false
use_wandb: false
use_tensorboard: true
log_every_n_steps: 20

# Paths
checkpoint_dir: "./checkpoints"
log_dir: "./logs"
output_dir: "./outputs"

# Reproducibility - SPEED MODE
seed: 42
deterministic: false
benchmark: true

# Production Features
enable_profiling: false
export_onnx: true
export_torchscript: true
save_config: true

# Target Metrics (World-class targets)
target_val_ade: 0.40       # Sub-0.5 yard accuracy
target_val_fde: 0.70
target_val_miss_rate: 0.05
target_val_cov_acc: 0.95
