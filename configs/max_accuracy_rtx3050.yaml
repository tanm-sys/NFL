# ============================================================================
# ðŸš€ MAXIMUM SPEED CONFIG - RTX 3050 4GB OPTIMIZED
# ============================================================================
# Fastest training while maintaining good accuracy.
# Optimized for RTX 3050 4GB VRAM.

experiment_name: "nfl_max_speed"
description: "Maximum speed training for RTX 3050 4GB"

# Data Configuration
data_dir: "."
weeks: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]  # ALL weeks
train_split: 0.8
val_split: 0.2
radius: 20.0
future_seq_len: 10
history_len: 5

# Model Architecture - BALANCED
input_dim: 9
hidden_dim: 256
num_gnn_layers: 6              # Reduced for speed
heads: 8
dropout: 0.1
droppath_rate: 0.1
probabilistic: true
num_modes: 6                   # Reduced for speed
use_scene_encoder: true
temporal_encoder_type: "lstm"  # Faster than hybrid

# Training - SPEED OPTIMIZED
batch_size: 48                 # Large for GPU utilization
accumulate_grad_batches: 3     # Effective batch = 144
learning_rate: 0.001
max_epochs: 50
min_epochs: 10

# Optimizer
optimizer: "adamw"
weight_decay: 0.02
betas: [0.9, 0.999]

# LR Scheduler
lr_scheduler: "cosine_warmup"
warmup_epochs: 3
min_lr: 1.0e-06

# Loss Weights
trajectory_weight: 1.0
velocity_weight: 0.3
acceleration_weight: 0.15
collision_weight: 0.05
coverage_weight: 0.4

# SOTA Losses
use_social_nce: true
social_nce_weight: 0.1
use_wta_loss: true
wta_k_best: 1
use_diversity_loss: true
diversity_weight: 0.02
use_endpoint_focal: true
endpoint_focal_weight: 0.15

# Regularization
gradient_clip_val: 1.0
use_augmentation: true
use_huber_loss: true
huber_delta: 1.0
label_smoothing: 0.05

# Hardware
precision: "16-mixed"
accelerator: "gpu"
devices: 1
benchmark: true
deterministic: false
num_workers: 2

# Caching - MAXIMUM
in_memory_cache_size: 100
persist_cache: true

# Callbacks
early_stopping_patience: 8
monitor_metric: "val_ade"
save_top_k: 3

# SWA
swa_enabled: true
swa_epoch_start: 0.7
swa_lrs: 1.0e-05

# Targets
target_val_ade: 0.45
target_val_fde: 0.75
